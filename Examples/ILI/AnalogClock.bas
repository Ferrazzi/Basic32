10 WIFI "SSID" "PASSWORD"
20 TIMEZONE IT
30 SYNCNTP
40 REM ==== ANALOG CLOCK ====
50 ILI SPEED 80 'IF YOU SEE ARTIFACTS, DROP TO 60 OR 40
60 ILI INIT 17 16 5 3
70 ILI LED 32 1
80 ILI SETBGCOLOR 0 0 0
90 ILI CLEAR
100 REM ==== DIGITAL ====
110 XDIG = 4
120 YDIG = 4
130 SDIG = 2
140 REM ==== CENTER AND DIMENSIONS ====
150 CX = 160
160 CY = 130
170 R = 90
180 FIRST = 1
190 REM ==== DRAW THE DIAL ONCE ====
200 GOSUB 260
210 ILI DRAW
220 REM ==== MAIN LOOP ====
230 GOSUB 390
240 GOTO 230
250 REM ================================
260 REM ==== DRAW THE DIAL ====
270 ILI CIRCLE CX CY R 255 255 255 0
280 FOR H = 0 TO 11
290 ANG = H * 30
300 A = 90 - ANG
310 XOUT = CX + R * COS(A)
320 YOUT = CY - R * SIN(A)
330 XIN = CX + (R-10) * COS(A)
340 YIN = CY - (R-10) * SIN(A)
350 ILI LINE XIN YIN XOUT YOUT 255 255 255 0
360 NEXT H
370 RETURN
380 REM ================================
390 REM ==== UPDATE HANDS + DIGITAL ====
400 HRS = TIMEH
410 MINS = TIMEM
420 SECS = TIMES
430 HH12 = HRS
440 HH12 = HH12 - INT(HH12 / 12) * 12
450 ANG_H = HH12 * 30.0 + (MINS * 0.5)
460 ANG_M = MINS * 6.0
470 ANG_S = SECS * 6.0
480 AH = 90.0 - ANG_H
490 AM = 90.0 - ANG_M
500 AS = 90.0 - ANG_S
510 LH = R * 0.5
520 LM = R * 0.75
530 LS = R * 0.9
540 XH = CX + LH * COS(AH)
550 YH = CY - LH * SIN(AH)
560 XM = CX + LM * COS(AM)
570 YM = CY - LM * SIN(AM)
580 XS = CX + LS * COS(AS)
590 YS = CY - LS * SIN(AS)
600 REM ==== ERASE OLD HANDS ====
610 IF FIRST = 0 THEN ILI LINE CX CY OLD_XH OLD_YH 0 0 0 0
620 IF FIRST = 0 THEN ILI LINE CX CY OLD_XM OLD_YM 0 0 0 0
630 IF FIRST = 0 THEN ILI LINE CX CY OLD_XS OLD_YS 0 0 0 0
640 REM ====RESTORE CIRCLE + MARKERS ====
650 IF FIRST = 0 THEN GOSUB 260
660 REM ==== DRAW NEW HANDS ====
670 ILI LINE CX CY XH YH 255 255 0 0
680 ILI LINE CX CY XM YM 0 255 0 0
690 ILI LINE CX CY XS YS 255 0 0 0
700 ILI FILLCIRCLE CX CY 4 255 0 0 0
710 REM ==== SAVE POSITIONS ====
720 OLD_XH = XH : OLD_YH = YH
730 OLD_XM = XM : OLD_YM = YM
740 OLD_XS = XS : OLD_YS = YS
750 FIRST = 0
760 REM ==== DIGITAL TOP-LEFT ====
770 T$ = ""
780 IF HRS < 10 THEN T$ = T$ + "0" + STR$(HRS) ELSE T$ = T$ + STR$(HRS)
790 T$ = T$ + ":"
800 IF MINS < 10 THEN T$ = T$ + "0" + STR$(MINS) ELSE T$ = T$ + STR$(MINS)
810 T$ = T$ + ":"
820 IF SECS < 10 THEN T$ = T$ + "0" + STR$(SECS) ELSE T$ = T$ + STR$(SECS)
830 ILI FILLRECT 0 0 140 20 0 0 0 0
840 ILI TEXT XDIG YDIG SDIG T$ 255 255 255 0
850 REM ==== SINGLE FLUSH ====
860 ILI DRAW
870 REM ==== WAIT FOR NEXT SECOND ====
880 S0 = SECS
890 S1 = TIMES
900 IF S1 = S0 THEN GOTO 890
910 RETURN
