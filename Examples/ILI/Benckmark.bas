5  ITER = 4999
10  REM --- INIZIALIZZAZIONE DISPLAY ILI9341 ---
20  ILI INIT 17 16 5 3
30  ILI LED 32 1
40  ILI SETBGCOLOR 0 0 0
50  ILI CLEAR
60  REM --- SPLASH SCREEN BASIC32 BENCHMARK (NUOVA) ---
70  REM SFONDO VERDE PIENO
80  ILI FILLRECT 0 0 320 240 0 60 0
90  REM CHIP CENTRALE
100  CHIPW = 140 : CHIPH = 100
110  CHIPX = (320 - CHIPW) / 2 : CHIPY = (240 - CHIPH) / 2
120  ILI FILLRECT CHIPX CHIPY CHIPW CHIPH 30 30 30
130  ILI RECT CHIPX CHIPY CHIPW CHIPH 220 220 220
140  REM PIN SINISTRA
150  FOR Y = CHIPY + 12 TO CHIPY + CHIPH - 12 STEP 10
160  ILI FILLRECT CHIPX - 10 Y 10 4 220 220 220
170  NEXT Y
180  REM PIN DESTRA
190  FOR Y = CHIPY + 12 TO CHIPY + CHIPH - 12 STEP 10
200  ILI FILLRECT CHIPX + CHIPW Y 10 4 220 220 220
210  NEXT Y
220  REM TITOLO E SOTTOTITOLO CENTRATI
230  TITLE$ = "Basic32 Benchmark" : TSIZE = 3
240  SUB$ = "Performance Test" : SSIZE = 2
250  TW = LEN(TITLE$) * 6 * TSIZE : SW = LEN(SUB$) * 6 * SSIZE
260  TX = (320 - TW) / 2 : SX = (320 - SW) / 2
270  TY = 10 : SY = 210
280  ILI TEXT TX TY TSIZE TITLE$ 255 255 0
281  ILI TEXT SX SY SSIZE SUB$ 0 255 255
282  DELAY 5000
283  ILI CLEAR
290  REM --- SCHERMATA PROGRESSO TEST ---
300  ILI TEXT 10 10 2 "Basic32 Benchmark" 255 255 0
310  IT$ = "ITER=" + STR$(ITER)
320  ILI TEXT 10 30 1 IT$ 255 255 255
330  ILI TEXT 10 60 1 "1 ARIT  :" 0 255 0
340  ILI TEXT 10 70 1 "2 LOGIC :" 0 255 0
350  ILI TEXT 10 80 1 "3 STR   :" 0 255 0
360  ILI TEXT 10 90 1 "4 BIT   :" 0 255 0
370  ILI TEXT 10 100 1 "5 ARRAY :" 0 255 0
380  ILI TEXT 10 110 1 "6 GOSUB :" 0 255 0
390  ILI TEXT 10 120 1 "7 MATH  :" 0 255 0
400  ILI TEXT 10 130 1 "8 RAND  :" 0 255 0
410  ILI TEXT 10 140 1 "9 LOOP  :" 0 255 0
420  ILI TEXT 10 150 1 "10 GFX  :" 0 255 0
430  REM --- TEST 1 ARITMETICA ---
440  ILI TEXT 140 60 1 "RUN..." 255 255 0
450  PRINT "INIZIO TEST 1 (ARITMETICA PURA)"
460  T0 = TI
470  S1 = 0
480  FOR I = 1 TO ITER
490  S1 = S1 + I * 3 - 7
500  NEXT I
510  DT1 = TI - T0
520  PRINT "FINE TEST 1"
530  PRINT "DT1="; DT1; " cs"
540  ILI FILLRECT 140 58 170 10 0 0 0
550  TXT$ = STR$(DT1) + " cs"
560  ILI TEXT 140 60 1 TXT$ 0 255 0
570  PRINT
580  REM --- TEST 2 CONDIZIONALI ---
590  ILI TEXT 140 70 1 "RUN..." 255 255 0
600  PRINT "INIZIO TEST 2 (IF / THEN / ELSE)"
610  T1 = TI
620  S2 = 0
630  FOR J = 1 TO ITER
640  IF J MOD 2 = 0 THEN S2 = S2 + J ELSE S2 = S2 - J
650  NEXT J
660  DT2 = TI - T1
670  PRINT "FINE TEST 2"
680  PRINT "DT2="; DT2; " cs"
690  ILI FILLRECT 140 68 170 10 0 0 0
700  TXT$ = STR$(DT2) + " cs"
710  ILI TEXT 140 70 1 TXT$ 0 255 0
720  PRINT
730  REM --- TEST 3 STRINGHE ---
740  ILI TEXT 140 80 1 "RUN..." 255 255 0
750  PRINT "INIZIO TEST 3 (MANIPOLAZIONE STRINGHE)"
760  T2 = TI
770  FOR K = 1 TO ITER
780  A$ = "ABC"
790  B$ = "XYZ"
800  C$ = A$ + B$
810  D = LEN(C$)
820  E$ = LEFT$(C$, 2)
830  F$ = RIGHT$(C$, 2)
840  NEXT K
850  DT3 = TI - T2
860  PRINT "FINE TEST 3"
870  PRINT "DT3="; DT3; " cs"
880  ILI FILLRECT 140 78 170 10 0 0 0
890  TXT$ = STR$(DT3) + " cs"
900  ILI TEXT 140 80 1 TXT$ 0 255 0
910  PRINT
920  REM --- TEST 4 BITWISE ---
930  ILI TEXT 140 90 1 "RUN..." 255 255 0
940  PRINT "INIZIO TEST 4 (OPERAZIONI BITWISE)"
950  T3 = TI
960  S4 = 0
970  FOR X = 1 TO ITER
980  A = X AND 255
990  B = X OR 128
1000  C = A XOR B
1010  D = A * 2
1020  E = B \ 2
1030  S4 = S4 + C + D + E
1040  NEXT X
1050  DT4 = TI - T3
1060  PRINT "FINE TEST 4"
1070  PRINT "DT4="; DT4; " cs"
1080  ILI FILLRECT 140 88 170 10 0 0 0
1090  TXT$ = STR$(DT4) + " cs"
1100  ILI TEXT 140 90 1 TXT$ 0 255 0
1110  PRINT
1120  REM --- TEST 5 ARRAY ---
1130  ILI TEXT 140 100 1 "RUN..." 255 255 0
1140  PRINT "INIZIO TEST 5 (ARRAY)"
1150  DIM ARR(ITER)
1160  FOR I = 1 TO ITER
1170  ARR(I) = I * 2
1180  NEXT I
1190  T4 = TI
1200  S5 = 0
1210  FOR I = 1 TO ITER
1220  S5 = S5 + ARR(I)
1230  NEXT I
1240  DT5 = TI - T4
1250  PRINT "FINE TEST 5"
1260  PRINT "DT5="; DT5; " cs"
1270  ILI FILLRECT 140 98 170 10 0 0 0
1280  TXT$ = STR$(DT5) + " cs"
1290  ILI TEXT 140 100 1 TXT$ 0 255 0
1300  PRINT
1310  REM --- TEST 6 GOSUB ---
1320  ILI TEXT 140 110 1 "RUN..." 255 255 0
1330  PRINT "INIZIO TEST 6 (GOSUB)"
1340  T5 = TI
1350  S6 = 0
1360  FOR I = 1 TO ITER
1370  GOSUB 9000
1380  NEXT I
1390  DT6 = TI - T5
1400  PRINT "FINE TEST 6"
1410  PRINT "DT6="; DT6; " cs"
1420  ILI FILLRECT 140 108 170 10 0 0 0
1430  TXT$ = STR$(DT6) + " cs"
1440  ILI TEXT 140 110 1 TXT$ 0 255 0
1450  PRINT
1460  REM --- TEST 7 FUNZIONI MATEMATICHE ---
1470  ILI TEXT 140 120 1 "RUN..." 255 255 0
1480  PRINT "INIZIO TEST 7 (FUNZIONI MATEMATICHE)"
1490  T6 = TI
1500  S7 = 0
1510  FOR I = 1 TO ITER
1520  A = SIN(I)
1530  B = COS(I)
1540  C = TAN(I/100)
1550  D = SQR(I)
1560  S7 = S7 + A + B + C + D
1570  NEXT I
1580  DT7 = TI - T6
1590  PRINT "FINE TEST 7"
1600  PRINT "DT7="; DT7; " cs"
1610  ILI FILLRECT 140 118 170 10 0 0 0
1620  TXT$ = STR$(DT7) + " cs"
1630  ILI TEXT 140 120 1 TXT$ 0 255 0
1640  PRINT
1650  REM --- TEST 8 RANDOM / RND ---
1660  ILI TEXT 140 130 1 "RUN..." 255 255 0
1670  PRINT "INIZIO TEST 8 (RANDOM / RND)"
1680  T7 = TI
1690  S8 = 0
1700  FOR I = 1 TO ITER
1710  R = RND(32767)
1720  S8 = S8 + R
1730  NEXT I
1740  DT8 = TI - T7
1750  PRINT "FINE TEST 8"
1760  PRINT "DT8="; DT8; " cs"
1770  ILI FILLRECT 140 128 170 10 0 0 0
1780  TXT$ = STR$(DT8) + " cs"
1790  ILI TEXT 140 130 1 TXT$ 0 255 0
1800  PRINT
1810  REM --- TEST 9 CICLO VUOTO ---
1820  ILI TEXT 140 140 1 "RUN..." 255 255 0
1830  PRINT "INIZIO TEST 9 (CICLO VUOTO)"
1840  T8 = TI
1850  FOR I = 1 TO ITER
1860  NEXT I
1870  DT9 = TI - T8
1880  PRINT "FINE TEST 9"
1890  PRINT "DT9="; DT9; " cs"
1900  ILI FILLRECT 140 138 170 10 0 0 0
1910  TXT$ = STR$(DT9) + " cs"
1920  ILI TEXT 140 140 1 TXT$ 0 255 0
1930  PRINT
1940  REM --- TEST 10 GRAFICA (FILLRECT) ---
1950  ILI TEXT 140 150 1 "RUN..." 255 255 0
1960  PRINT "INIZIO TEST 10 (GRAFICA FILLRECT)"
1970  ILI CLEAR
1980  T9 = TI
1990  X = 0
2000  Y = 0
2010  FOR I = 1 TO ITER
2020  ILI FILLRECT X Y 4 4 0 255 0
2030  X = X + 5
2040  IF X > 315 THEN X = 0 : Y = Y + 5
2050  IF Y > 235 THEN Y = 0
2060  NEXT I
2070  DT10 = TI - T9
2080  PRINT "FINE TEST 10"
2090  PRINT "DT10="; DT10; " cs"
2100  ILI CLEAR
2110  GOSUB 4000
2120  PRINT
2130  REM --- RISULTATI SU SERIALE (SAFE) ---
2140  PRINT
2150  PRINT "=== RISULTATI FINALI ==="
2160  SEC1 = DT1 / 100
2170  RES$ = "TEST1 ARIT      =" + STR$(DT1) + " cs (" + STR$(SEC1) + " sec)"
2180  PRINT RES$
2190  SEC2 = DT2 / 100
2200  RES$ = "TEST2 LOGICA    =" + STR$(DT2) + " cs (" + STR$(SEC2) + " sec)"
2210  PRINT RES$
2220  SEC3 = DT3 / 100
2230  RES$ = "TEST3 STRINGHE  =" + STR$(DT3) + " cs (" + STR$(SEC3) + " sec)"
2240  PRINT RES$
2250  SEC4 = DT4 / 100
2260  RES$ = "TEST4 BITWISE   =" + STR$(DT4) + " cs (" + STR$(SEC4) + " sec)"
2270  PRINT RES$
2280  SEC5 = DT5 / 100
2290  RES$ = "TEST5 ARRAY     =" + STR$(DT5) + " cs (" + STR$(SEC5) + " sec)"
2300  PRINT RES$
2310  SEC6 = DT6 / 100
2320  RES$ = "TEST6 GOSUB     =" + STR$(DT6) + " cs (" + STR$(SEC6) + " sec)"
2330  PRINT RES$
2340  SEC7 = DT7 / 100
2350  RES$ = "TEST7 MATH      =" + STR$(DT7) + " cs (" + STR$(SEC7) + " sec)"
2360  PRINT RES$
2370  SEC8 = DT8 / 100
2380  RES$ = "TEST8 RANDOM    =" + STR$(DT8) + " cs (" + STR$(SEC8) + " sec)"
2390  PRINT RES$
2400  SEC9 = DT9 / 100
2410  RES$ = "TEST9 LOOP      =" + STR$(DT9) + " cs (" + STR$(SEC9) + " sec)"
2420  PRINT RES$
2430  SEC10 = DT10 / 100
2440  RES$ = "TEST10 GRAFICA  =" + STR$(DT10) + " cs (" + STR$(SEC10) + " sec)"
2450  PRINT RES$
2460  TOTS = DT1 + DT2 + DT3 + DT4 + DT5 + DT6 + DT7 + DT8 + DT9 + DT10
2470  TOTSEC = TOTS / 100
2480  PRINT
2490  PRINT "TOT CS="; TOTS
2500  PRINT "TOT SEC="; TOTSEC
2510  REM --- MFLOPS SU TEST 1 (SAFE) ---
2520  OPS = ITER * 2
2530  TF = DT1 / 100
2540  MFLOPS = (OPS / TF) / 1000000
2550  PRINT
2560  PRINT "MFLOPS (TEST1 ARITMETICA):"; MFLOPS
2570  REM --- ATTESA PRIMA DEL GRAFICO ---
2580  DELAY 5000
2590  REM --- SCHERMATA FINALE CON GRAFICO ---
2600  ILI CLEAR
2610  ILI TEXT 10 10 2 "RISULTATI BENCH" 255 255 0
2620  IT$ = "ITER=" + STR$(ITER)
2630  ILI TEXT 10 30 1 IT$ 255 255 255
2640  REM --- ETICHETTE TEST ---
2650  ILI TEXT 10 60 1 "1 ARIT  :" 255 255 255
2660  ILI TEXT 10 70 1 "2 LOGIC :" 255 255 255
2670  ILI TEXT 10 80 1 "3 STR   :" 255 255 255
2680  ILI TEXT 10 90 1 "4 BIT   :" 255 255 255
2690  ILI TEXT 10 100 1 "5 ARRAY :" 255 255 255
2700  ILI TEXT 10 110 1 "6 GOSUB :" 255 255 255
2710  ILI TEXT 10 120 1 "7 MATH  :" 255 255 255
2720  ILI TEXT 10 130 1 "8 RAND  :" 255 255 255
2730  ILI TEXT 10 140 1 "9 LOOP  :" 255 255 255
2740  ILI TEXT 10 150 1 "10 GFX  :" 255 255 255
2750  REM --- CALCOLO MASSIMO PER SCALA ---
2760  MAXT = DT1
2770  IF DT2 > MAXT THEN MAXT = DT2
2780  IF DT3 > MAXT THEN MAXT = DT3
2790  IF DT4 > MAXT THEN MAXT = DT4
2800  IF DT5 > MAXT THEN MAXT = DT5
2810  IF DT6 > MAXT THEN MAXT = DT6
2820  IF DT7 > MAXT THEN MAXT = DT7
2830  IF DT8 > MAXT THEN MAXT = DT8
2840  IF DT9 > MAXT THEN MAXT = DT9
2850  IF DT10 > MAXT THEN MAXT = DT10
2860  SCALE = 200 / MAXT
2870  SEC_MAX = MAXT / 100
2880  SEC_Q1 = SEC_MAX / 4
2890  SEC_Q2 = SEC_MAX / 2
2900  SEC_Q3 = SEC_MAX * 3 / 4
2910  REM --- SCALA TEMPORALE (SAFE: STRINGHE PRONTE) ---
2920  BASEX = 70
2930  ILI TEXT BASEX 50 1 "0" 255 255 255
2940  TXT$ = STR$(SEC_Q1) : ILI TEXT BASEX+50 50 1 TXT$ 255 255 255
2950  TXT$ = STR$(SEC_Q2) : ILI TEXT BASEX+100 50 1 TXT$ 255 255 255
2960  TXT$ = STR$(SEC_Q3) : ILI TEXT BASEX+150 50 1 TXT$ 255 255 255
2970  TXT$ = STR$(SEC_MAX): ILI TEXT BASEX+200 50 1 TXT$ 255 255 255
2980  REM --- LARGHEZZA BARRE ---
2990  BW1 = DT1 * SCALE
3000  BW2 = DT2 * SCALE
3010  BW3 = DT3 * SCALE
3020  BW4 = DT4 * SCALE
3030  BW5 = DT5 * SCALE
3040  BW6 = DT6 * SCALE
3050  BW7 = DT7 * SCALE
3060  BW8 = DT8 * SCALE
3070  BW9 = DT9 * SCALE
3080  BW10 = DT10 * SCALE
3090  HGT = 6
3100  REM --- BARRE ---
3110  ILI FILLRECT BASEX 60 BW1 HGT 0 255 0
3120  ILI FILLRECT BASEX 70 BW2 HGT 0 200 255
3130  ILI FILLRECT BASEX 80 BW3 HGT 255 0 0
3140  ILI FILLRECT BASEX 90 BW4 HGT 255 255 0
3150  ILI FILLRECT BASEX 100 BW5 HGT 0 255 255
3160  ILI FILLRECT BASEX 110 BW6 HGT 255 0 255
3170  ILI FILLRECT BASEX 120 BW7 HGT 255 128 0
3180  ILI FILLRECT BASEX 130 BW8 HGT 128 255 0
3190  ILI FILLRECT BASEX 140 BW9 HGT 128 128 255
3200  ILI FILLRECT BASEX 150 BW10 HGT 255 255 255
3210  TXT$ = "TOT SEC=" + STR$(TOTSEC)
3220  ILI TEXT 10 175 1 TXT$ 0 255 0
3230  TXT$ = "MFLOPS=" + STR$(MFLOPS)
3240  ILI TEXT 10 190 1 TXT$ 0 255 0
3250  END
4000  REM --- RIDISEGNA SCHERMATA PROGRESSO DOPO TEST GRAFICO ---
4010  ILI TEXT 10 10 2 "Basic32 Benchmark" 255 255 0
4020  IT$ = "ITER=" + STR$(ITER)
4030  ILI TEXT 10 30 1 IT$ 255 255 255
4040  ILI TEXT 10 60 1 "1 ARIT  :" 0 255 0
4050  ILI TEXT 10 70 1 "2 LOGIC :" 0 255 0
4060  ILI TEXT 10 80 1 "3 STR   :" 0 255 0
4070  ILI TEXT 10 90 1 "4 BIT   :" 0 255 0
4080  ILI TEXT 10 100 1 "5 ARRAY :" 0 255 0
4090  ILI TEXT 10 110 1 "6 GOSUB :" 0 255 0
4100  ILI TEXT 10 120 1 "7 MATH  :" 0 255 0
4110  ILI TEXT 10 130 1 "8 RAND  :" 0 255 0
4120  ILI TEXT 10 140 1 "9 LOOP  :" 0 255 0
4130  ILI TEXT 10 150 1 "10 GFX  :" 0 255 0
4140  TXT$ = STR$(DT1) + " cs" : ILI TEXT 140 60 1 TXT$ 0 255 0
4150  TXT$ = STR$(DT2) + " cs" : ILI TEXT 140 70 1 TXT$ 0 255 0
4160  TXT$ = STR$(DT3) + " cs" : ILI TEXT 140 80 1 TXT$ 0 255 0
4170  TXT$ = STR$(DT4) + " cs" : ILI TEXT 140 90 1 TXT$ 0 255 0
4180  TXT$ = STR$(DT5) + " cs" : ILI TEXT 140 100 1 TXT$ 0 255 0
4190  TXT$ = STR$(DT6) + " cs" : ILI TEXT 140 110 1 TXT$ 0 255 0
4200  TXT$ = STR$(DT7) + " cs" : ILI TEXT 140 120 1 TXT$ 0 255 0
4210  TXT$ = STR$(DT8) + " cs" : ILI TEXT 140 130 1 TXT$ 0 255 0
4220  TXT$ = STR$(DT9) + " cs" : ILI TEXT 140 140 1 TXT$ 0 255 0
4230  TXT$ = STR$(DT10) + " cs" : ILI TEXT 140 150 1 TXT$ 0 255 0
4240  RETURN
9000  REM --- SUB PER TEST 6 ---
9010  S6 = S6 + 1
9020  RETURN
