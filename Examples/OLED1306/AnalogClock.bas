10 WIFI "SSID" "PASSWORD"
20 TIMEZONE IT
30 SYNCNTP
40 REM ==== ANALOG CLOCK OLED ====
50 OLED INIT 128 64 3C
60 W = 128 : H = 64
70 CX = 64
80 CY = 32
90 R = 30
100 REM ==== DIRTY RECT (CLOCK AREA) ====
110 XD = CX - R - 2
120 YD = CY - R - 2
130 WD = (R + 2) * 2
140 HD = (R + 2) * 2
150 IF XD < 0 THEN XD = 0
160 IF YD < 0 THEN YD = 0
170 IF XD + WD > W THEN WD = W - XD
180 IF YD + HD > H THEN HD = H - YD
190 REM ==== MAIN LOOP ====
200 GOSUB 300
210 GOTO 200
300 REM =========================
310 REM BUILD FRAME IN BUFFER
320 REM =========================
330 REM ==== CLEAR BUFFER ONLY (NO IMMEDIATE UPDATE) ====
340 OLED FILLRECT 0 0 128 64 BLACK 0
350 REM ==== DIAL ====
360 OLED CIRCLE CX CY R WHITE 0
370 FOR HH = 0 TO 11
380 ANG = HH * 30
390 A = 90 - ANG
400 XOUT = CX + R * COS(A)
410 YOUT = CY - R * SIN(A)
420 XIN = CX + (R-4) * COS(A)
430 YIN = CY - (R-4) * SIN(A)
440 OLED LINE XIN YIN XOUT YOUT WHITE 0
450 NEXT HH
460 REM ==== TIME ====
470 HRS = TIMEH
480 MINS = TIMEM
490 SECS = TIMES
500 HH12 = HRS - INT(HRS / 12) * 12
510 ANG_H = HH12 * 30 + MINS * 0.5
520 ANG_M = MINS * 6
530 ANG_S = SECS * 6
540 AH = 90 - ANG_H
550 AM = 90 - ANG_M
560 AS = 90 - ANG_S
570 LH = R * 0.55
580 LM = R * 0.80
590 LS = R * 0.92
600 XH = CX + LH * COS(AH)
610 YH = CY - LH * SIN(AH)
620 XM = CX + LM * COS(AM)
630 YM = CY - LM * SIN(AM)
640 XS = CX + LS * COS(AS)
650 YS = CY - LS * SIN(AS)
660 REM ==== HANDS ====
670 OLED LINE CX CY XH YH WHITE 0
680 OLED LINE CX CY XM YM WHITE 0
690 OLED LINE CX CY XS YS WHITE 0
700 OLED FILLCIRCLE CX CY 2 WHITE 0
710 REM ==== UPDATE ONLY CLOCK AREA ====
720 OLED DRAWRECT XD YD WD HD
730 REM ==== WAIT NEXT SECOND ====
740 S0 = SECS
750 IF TIMES = S0 THEN GOTO 750
760 RETURN
