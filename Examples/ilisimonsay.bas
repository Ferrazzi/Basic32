1 SOUND = 1
2 BUZZER = 2
3 SCORE = 0
4 DIM SEQ(512)
10 ILI INIT 17 16 5 3
20 ILI LED 32 1
30 ILI INIT TOUCH 4 3
35 ILI CLEAR
40 IF TOUCH CALIBRATE = 0 THEN ILI TOUCH CALIBRATE
50 REM === MAIN SCREEN MENU ===
51 ILI CLEAR
55 ILI SPRITE CLEAR
60 ILI FILLRECT 0 0 319 239 178 226 255
80 ILI RECT 32 120 256 32 255 0 0
90 ILI RECT 32 64 256 32 255 0 0
100 ILI SPRITE NEW 1 RECT 33 65 254 30 25 83 255
110 ILI SPRITE NEW 2 RECT 33 121 254 30 25 83 255
125 ILI SPRITE DRAW
130 ILI TEXT 90 16 3 "SIMON SAY" 255 0 0
140 ILI TEXT 104 73 2 "START GAME" 255 0 0
150 ILI TEXT 112 129 2 "SETTINGS" 255 0 0
170 ILI TOUCH SPRITE 1 GOTO 1000 DOWN DEBOUNCE 200
180 ILI TOUCH SPRITE 2 GOTO 2000 DOWN DEBOUNCE 200
200 GOTO 170
1000 REM === GAME SCREEN ===
1005 ILI CLEAR
1006 ILI SPRITE CLEAR
1010 ILI FILLRECT 0 0 319 239 0 0 0
1020 ILI TEXT 80 10 3 "SCORE " 255 255 255
1030 ILI SPRITE NEW 7 TEXT 200 10 3 STR$(SCORE) 255 255 0
1040 ILI SPRITE DRAW
1050 ILI SPRITE NEW 8 RECT 20 60 130 80 255 255 0
1060 ILI SPRITE NEW 9 RECT 170 60 130 80 0 255 0
1070 ILI SPRITE NEW 10 RECT 20 150 130 80 255 0 0
1080 ILI SPRITE NEW 11 RECT 170 150 130 80 0 0 255
1090 ILI SPRITE DRAW
1100 REM === START GAME ===
1110 LEVEL = 1
1120 LEN = 1
1130 SEQ(1) = RND(1, 5)
1135 IDX = 1
1140 SPEED = 800
1150 GOTO 1300
1200 REM === LOOP INPUT ===
1210 ILI TOUCH SPRITE ANY SET S DOWN
1220 IF S = 0 THEN GOTO 1210
1225 C = 0
1230 IF S = 8 THEN C = 1
1240 IF S = 9 THEN C = 2
1250 IF S = 10 THEN C = 3
1260 IF S = 11 THEN C = 4
1265 IF C = 0 THEN GOTO 1210
1270 GOSUB 1700
1280 IF C <> SEQ(IDX) THEN GOTO 1500
1290 IDX = IDX + 1
1292 IF IDX <= LEN THEN GOTO 1210
1294 GOTO 1380
1300 REM === PLAYBACK SEQUENCE ===
1310 K = 1
1320 IF K > LEN THEN GOTO 1400
1330 C = SEQ(K)
1340 GOSUB 1700
1350 WAIT (SPEED / 2)
1360 K = K + 1
1370 GOTO 1320
1380 IF LEVEL > 12 THEN SPEED = 300
1381 SCORE = SCORE + 1
1382 ILI SPRITE SETTEXT 7 STR$(SCORE) 255 255 0
1383 ILI SPRITE DRAW 7
1384 REM === UPDATE LEVEL AND SPEED ===
1385 LEVEL = LEVEL + 1
1386 IF LEVEL <= 4 THEN SPEED = 800
1387 IF LEVEL > 4 AND LEVEL <= 8 THEN SPEED = 600
1388 IF LEVEL > 8 AND LEVEL <= 12 THEN SPEED = 400
1389 IF LEVEL > 12 THEN SPEED = 300
1390 IF LEN < 512 THEN LEN = LEN + 1
1395 SEQ(LEN) = RND(1, 5)
1397 GOTO 1300
1400 REM === INPUT ===
1410 IDX = 1
1420 GOTO 1210
1500 REM === END GAME ===
1510 IF SOUND = 1 THEN TONE BUZZER "F3" 400
1520 ILI TEXT 70 120 3 "GAME OVER" 255 0 0
1525 SCORE = 0
1530 WAIT 1000
1540 GOTO 50
1700 REM === FLASH + TONE ===
1710 IF C = 1 THEN ILI FILLRECT 20 60 130 80 255 255 200
1720 IF C = 2 THEN ILI FILLRECT 170 60 130 80 200 255 200
1730 IF C = 3 THEN ILI FILLRECT 20 150 130 80 255 180 180
1740 IF C = 4 THEN ILI FILLRECT 170 150 130 80 180 180 255
1750 IF SOUND = 1 THEN IF C = 1 THEN TONE BUZZER "C5" (SPEED - 100)
1760 IF SOUND = 1 THEN IF C = 2 THEN TONE BUZZER "E5" (SPEED - 100)
1770 IF SOUND = 1 THEN IF C = 3 THEN TONE BUZZER "G5" (SPEED - 100)
1780 IF SOUND = 1 THEN IF C = 4 THEN TONE BUZZER "B5" (SPEED - 100)
1790 IF (SPEED - 100) < 100 THEN IF SOUND = 1 THEN TONE BUZZER "C5" 100
1800 WAIT SPEED
1810 ILI SPRITE DRAW
1820 RETURN
2000 REM === SETTINGS SCREEN ===
2005 ILI CLEAR
2006 ILI SPRITE CLEAR
2010 ILI FILLRECT 0 0 319 239 178 226 255
2020 ILI TEXT 88 16 3 "SETTINGS" 255 0 0
2030 ILI RECT 32 64 256 32 255 0 0
2035 ILI RECT 32 176 256 32 255 0 0
2040 ILI SPRITE NEW 4 RECT 33 65 254 30 25 83 255
2041 ILI SPRITE NEW 5 RECT 33 177 254 30 25 83 255
2042 ILI SPRITE NEW 6 TEXT 220 73 2 "ON" 255 0 0
2043 IF SOUND = 0 THEN ILI SPRITE SETTEXT 6 "OFF" 255 0 0 ELSE ILI SPRITE SETTEXT 6 "ON" 255 0 0
2045 ILI SPRITE DRAW
2050 ILI TEXT 72 73 2 "SOUND" 255 0 0
2070 ILI TEXT 140 185 2 "BACK" 255 0 0
2080 ILI TOUCH SPRITE 5 GOTO 50 DOWN DEBOUNCE 200
2090 ILI TOUCH SPRITE 4 GOTO 2110 DOWN DEBOUNCE 200
2100 GOTO 2050
2110 IF SOUND = 0 THEN SOUND = 1 ELSE SOUND = 0
2115 IF SOUND = 1 THEN TONE BUZZER "C5" 300
2120 IF SOUND = 0 THEN ILI SPRITE SETTEXT 6 "OFF" 255 0 0 ELSE ILI SPRITE SETTEXT 6 "ON" 255 0 0
2130 ILI SPRITE DRAW 6
2140 ILI SPRITE DRAW
2150 GOTO 2080
