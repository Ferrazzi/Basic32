<!doctype html>
<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Basic32 — Manual</title>
    <meta name="description" content="BASIC32 programming manual" />
    <meta name="theme-color" content="#40318d" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">

    <!-- Styles -->
    <link rel="stylesheet" href="style.css" />

    <!-- Mini-stili SOLO per il rail alfabetico, il resto usa style.css -->
    <style>
      .sidebar-grid{
        display:grid;
        grid-template-columns: 36px 1fr; /* rail a sinistra, lista a destra */
        gap: 8px;
        height: 100%;
      }
      .alpha-rail{
        display:flex;
        flex-direction:column;
        align-items:center;
        gap:4px;
        user-select:none;
        position:sticky;
        top:8px; /* resta visibile mentre scorri l'indice */
      }
      .alpha-rail button{
        width:32px;height:28px;
        border:2px solid var(--c64-border);
        border-radius:8px;
        background:rgba(0,0,0,.12);
        color:var(--c64-text);
        font-family:'VT323', ui-monospace, monospace;
        font-size:16px; line-height:1;
        cursor:pointer;
        transition: transform .08s ease, filter .2s ease;
      }
      .alpha-rail button:hover{ transform:translateY(-2px); filter:brightness(1.15); }
      .alpha-rail button:focus-visible{ outline:3px solid var(--c64-text); outline-offset:2px; }
      @media (max-width:900px){
        /* su mobile, il rail va sopra la lista per non sprecare orizzontale */
        .sidebar-grid{ grid-template-columns: 1fr; }
        .alpha-rail{ flex-direction:row; flex-wrap:wrap; justify-content:center; position:static; }
        .alpha-rail button{ width:34px; height:30px; }
      }
    </style>
  </head>

  <body class="c64">
    <div class="crt" aria-hidden="true"></div>

    <div class="frame">
      <!-- ======= HEADER ======= -->
      <header class="header" role="banner">
        <a class="brand" href="index.html" aria-label="Home">
          <img
            src="https://raw.githubusercontent.com/Ferrazzi/Basic32/main/Logo.png"
            alt="Basic32"
            width="180" height="100"
            decoding="async" fetchpriority="high"
          />
        </a>

        <nav class="topnav" aria-label="Primaria">
          <a class="navitem" href="index.html">Flash</a>
          <a class="navitem" href="terminal.html">Serial Monitor</a>
          <a class="navitem" href="manual.html" aria-current="page">Manual</a>
        </nav>
      </header>

      <!-- ======= TOOLBAR ======= -->
      <section class="content" style="padding-bottom:16px;">
        <h1>BASIC32 programming manual</h1>

        <div class="controls" role="search" aria-label="Find in manual" style="display:flex;gap:12px;flex-wrap:wrap;justify-content:center;margin-top:8px;">
          <label for="search" class="visually-hidden">Search command</label>
          <input id="search" type="search" placeholder="Search command (e.g., RUN)..." autocomplete="off" />

          <label>
            Language
            <select id="lang" aria-label="Select language">
              <option value="it" selected>Italiano</option>
              <option value="en">English</option>
              <!-- Add more languages by creating manual.<code>.js -->
            </select>
          </label>
        </div>
      </section>

      <!-- ======= LAYOUT: SIDEBAR + CONTENUTO ======= -->
      <div class="manual-layout">
        <!-- Indice comandi -->
        <aside class="sidebar" aria-label="Commands index">
          <div class="sidebar-grid">
            <!-- Rail alfabetico verticale -->
            <div class="alpha-rail" aria-label="Alphabetical filter">
              <!-- # per simboli/numeri -->
              <button type="button" data-filter="0">#</button>
              <!-- A–Z -->
              <button type="button" data-filter="A">A</button>
              <button type="button" data-filter="B">B</button>
              <button type="button" data-filter="C">C</button>
              <button type="button" data-filter="D">D</button>
              <button type="button" data-filter="E">E</button>
              <button type="button" data-filter="F">F</button>
              <button type="button" data-filter="G">G</button>
              <button type="button" data-filter="H">H</button>
              <button type="button" data-filter="I">I</button>
              <button type="button" data-filter="J">J</button>
              <button type="button" data-filter="K">K</button>
              <button type="button" data-filter="L">L</button>
              <button type="button" data-filter="M">M</button>
              <button type="button" data-filter="N">N</button>
              <button type="button" data-filter="O">O</button>
              <button type="button" data-filter="P">P</button>
              <button type="button" data-filter="Q">Q</button>
              <button type="button" data-filter="R">R</button>
              <button type="button" data-filter="S">S</button>
              <button type="button" data-filter="T">T</button>
              <button type="button" data-filter="U">U</button>
              <button type="button" data-filter="V">V</button>
              <button type="button" data-filter="W">W</button>
              <button type="button" data-filter="X">X</button>
              <button type="button" data-filter="Y">Y</button>
              <button type="button" data-filter="Z">Z</button>
              <!-- reset -->
              <button type="button" data-filter="">⟲</button>
            </div>

            <!-- Lista comandi (popolata via manual-core.js) -->
            <nav id="command-list" class="command-list" aria-label="Elenco comandi">
              <!-- Popolato da manual-core.js -->
            </nav>
          </div>
        </aside>

        <!-- Contenuto del manuale -->
        <main id="manual-content" class="manual-content" tabindex="-1">
          <p class="hint">Select a command from the index or start typing in the search box.</p>
        </main>
      </div>
    </div>

    <!-- ======= NOSCRIPT ======= -->
    <noscript>
      <div class="frame" style="margin-top:12px">
        <p class="noscript">⚠️ JavaScript is disabled: index and filter will not work.</p>
      </div>
    </noscript>

    <!-- ======= SCRIPT ======= -->
    <script type="module" src="manual-core.js"></script>

    <!-- Piccolo script per far funzionare il rail senza toccare manual-core.js -->
    <script>
      (function(){
        const rail = document.querySelector('.alpha-rail');
        const search = document.getElementById('search');
        if (!rail || !search) return;
        rail.addEventListener('click', (e) => {
          const btn = e.target.closest('button[data-filter]');
          if (!btn) return;
          const f = btn.getAttribute('data-filter') || '';
          if (f === '') {
            // reset filtro
            search.value = '';
          } else if (f === '0') {
            // filtra numeri/simboli: inserisco carattere # come promemoria
            search.value = '#';
          } else {
            // imposta lettera selezionata
            search.value = f;
          }
          // scatena l'evento input così manual-core ricalcola l'indice
          const ev = new Event('input', { bubbles: true });
          search.dispatchEvent(ev);
          // scroll al top dell'indice
          const list = document.getElementById('command-list');
          if (list) list.scrollTop = 0;
        });
      })();
    </script>
  </body>
</html>

